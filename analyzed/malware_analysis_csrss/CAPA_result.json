{
  "binary_info": {
    "path": "/Users/neverfade/MCP_intent/binary/csrss.exe",
    "name": "csrss.exe",
    "size": 38616,
    "modified": "2025-09-15T20:28:15.390610"
  },
  "analysis_summary": {
    "total_capabilities": 2,
    "high_risk_count": 0,
    "medium_risk_count": 1,
    "low_risk_count": 1,
    "mitre_techniques": 0,
    "function_addresses": 0
  },
  "capabilities": {
    "all": [
      "contain loop",
      "terminate process"
    ],
    "high_risk": [],
    "medium_risk": [
      "terminate process"
    ],
    "low_risk": [
      "contain loop"
    ]
  },
  "mitre_attack": [],
  "function_addresses": [],
  "namespace_analysis": {
    "host-interaction/process/terminate": [
      "terminate process"
    ]
  },
  "full_capa_results": {
    "meta": {
      "timestamp": "2025-09-15T20:31:07.416110",
      "version": "9.2.1",
      "argv": [
        "-r",
        "/Users/neverfade/capa-rules",
        "-s",
        "/Users/neverfade/capa-sigs",
        "/Users/neverfade/MCP_intent/binary/csrss.exe",
        "--json"
      ],
      "sample": {
        "md5": "696fb9d7e43f428634f31cf56361d7c3",
        "sha1": "9006ccac001d1352d004788ac1d134bd266a82d7",
        "sha256": "eac814cee400a078e2d549ba6e3d7bd09d1bc9805a1c6c9ec0610a0e558472a1",
        "path": "/Users/neverfade/MCP_intent/binary/csrss.exe"
      },
      "flavor": "static",
      "analysis": {
        "format": "pe",
        "arch": "amd64",
        "os": "windows",
        "extractor": "VivisectFeatureExtractor",
        "rules": [
          "/Users/neverfade/capa-rules"
        ],
        "base_address": {
          "type": "absolute",
          "value": 5368709120
        },
        "layout": {
          "functions": [
            {
              "address": {
                "type": "absolute",
                "value": 5368713264
              },
              "matched_basic_blocks": [
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368713536
                  }
                },
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368713563
                  }
                },
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368713616
                  }
                },
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368713632
                  }
                },
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368713652
                  }
                },
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368713681
                  }
                },
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368713740
                  }
                },
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368713814
                  }
                },
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368713824
                  }
                },
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368713936
                  }
                },
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368713952
                  }
                },
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368714046
                  }
                },
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368714063
                  }
                },
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368715167
                  }
                }
              ]
            },
            {
              "address": {
                "type": "absolute",
                "value": 5368714096
              },
              "matched_basic_blocks": [
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368714096
                  }
                },
                {
                  "address": {
                    "type": "absolute",
                    "value": 5368714315
                  }
                }
              ]
            }
          ]
        },
        "feature_counts": {
          "file": 305,
          "functions": [
            {
              "address": {
                "type": "absolute",
                "value": 5368713232
              },
              "count": 13
            },
            {
              "address": {
                "type": "absolute",
                "value": 5368713264
              },
              "count": 107
            },
            {
              "address": {
                "type": "absolute",
                "value": 5368714096
              },
              "count": 78
            },
            {
              "address": {
                "type": "absolute",
                "value": 5368714876
              },
              "count": 38
            },
            {
              "address": {
                "type": "absolute",
                "value": 5368714976
              },
              "count": 8
            },
            {
              "address": {
                "type": "absolute",
                "value": 5368714988
              },
              "count": 8
            },
            {
              "address": {
                "type": "absolute",
                "value": 5368715000
              },
              "count": 8
            },
            {
              "address": {
                "type": "absolute",
                "value": 5368715012
              },
              "count": 8
            },
            {
              "address": {
                "type": "absolute",
                "value": 5368715024
              },
              "count": 8
            },
            {
              "address": {
                "type": "absolute",
                "value": 5368715056
              },
              "count": 7
            },
            {
              "address": {
                "type": "absolute",
                "value": 5368715120
              },
              "count": 8
            }
          ]
        },
        "library_functions": [
          {
            "address": {
              "type": "absolute",
              "value": 5368714416
            },
            "name": "__security_check_cookie"
          },
          {
            "address": {
              "type": "absolute",
              "value": 5368714464
            },
            "name": "__report_gsfailure"
          },
          {
            "address": {
              "type": "absolute",
              "value": 5368714800
            },
            "name": "__security_init_cookie"
          },
          {
            "address": {
              "type": "absolute",
              "value": 5368715088
            },
            "name": "_guard_dispatch_icall_nop"
          }
        ]
      }
    },
    "rules": {
      "contain loop": {
        "meta": {
          "name": "contain loop",
          "authors": [
            "moritz.raabe@mandiant.com"
          ],
          "scopes": {
            "static": "function"
          },
          "attack": [],
          "mbc": [],
          "references": [],
          "examples": [
            "08AC667C65D36D6542917655571E61C8:0x406EAA"
          ],
          "description": "",
          "lib": true,
          "is_subscope_rule": false,
          "maec": {}
        },
        "source": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
        "matches": [
          [
            {
              "type": "absolute",
              "value": 5368713264
            },
            {
              "success": true,
              "node": {
                "type": "statement",
                "statement": {
                  "type": "or"
                }
              },
              "children": [
                {
                  "success": true,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "characteristic",
                      "characteristic": "loop"
                    }
                  },
                  "children": [],
                  "locations": [
                    {
                      "type": "absolute",
                      "value": 5368713264
                    }
                  ],
                  "captures": {}
                },
                {
                  "success": true,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "characteristic",
                      "characteristic": "tight loop"
                    }
                  },
                  "children": [],
                  "locations": [
                    {
                      "type": "absolute",
                      "value": 5368713632
                    },
                    {
                      "type": "absolute",
                      "value": 5368713952
                    }
                  ],
                  "captures": {}
                },
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "characteristic",
                      "characteristic": "recursive call"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                }
              ],
              "locations": [],
              "captures": {}
            }
          ]
        ]
      },
      "terminate process": {
        "meta": {
          "name": "terminate process",
          "namespace": "host-interaction/process/terminate",
          "authors": [
            "moritz.raabe@mandiant.com",
            "michael.hunhoff@mandiant.com",
            "anushka.virgaonkar@mandiant.com"
          ],
          "scopes": {
            "static": "function",
            "dynamic": "thread"
          },
          "attack": [],
          "mbc": [
            {
              "parts": [
                "Process",
                "Terminate Process"
              ],
              "objective": "Process",
              "behavior": "Terminate Process",
              "method": "",
              "id": "C0018"
            }
          ],
          "references": [],
          "examples": [
            "C91887D861D9BD4A5872249B641BC9F9:0x401A77",
            "9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307"
          ],
          "description": "",
          "lib": false,
          "is_subscope_rule": false,
          "maec": {}
        },
        "source": "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n",
        "matches": [
          [
            {
              "type": "absolute",
              "value": 5368713264
            },
            {
              "success": true,
              "node": {
                "type": "statement",
                "statement": {
                  "type": "or"
                }
              },
              "children": [
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "api",
                      "api": "System.Diagnostics.Process::Kill"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                },
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "api",
                      "api": "System.Diagnostics.Process::WaitForExit"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                },
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "api",
                      "api": "System.Diagnostics.Process::WaitForExitAsync"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                },
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "api",
                      "api": "System.Environment::Exit"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                },
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "api",
                      "api": "System.Windows.Forms.Application::Exit"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                },
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "api",
                      "api": "exit"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                },
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "api",
                      "api": "Exit"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                },
                {
                  "success": true,
                  "node": {
                    "type": "statement",
                    "statement": {
                      "type": "and"
                    }
                  },
                  "children": [
                    {
                      "success": true,
                      "node": {
                        "type": "statement",
                        "statement": {
                          "type": "optional"
                        }
                      },
                      "children": [
                        {
                          "success": false,
                          "node": {
                            "type": "feature",
                            "feature": {
                              "type": "match",
                              "match": "open process"
                            }
                          },
                          "children": [],
                          "locations": [],
                          "captures": {}
                        }
                      ],
                      "locations": [],
                      "captures": {}
                    },
                    {
                      "success": true,
                      "node": {
                        "type": "statement",
                        "statement": {
                          "type": "or"
                        }
                      },
                      "children": [
                        {
                          "success": false,
                          "node": {
                            "type": "feature",
                            "feature": {
                              "type": "api",
                              "api": "TerminateProcess"
                            }
                          },
                          "children": [],
                          "locations": [],
                          "captures": {}
                        },
                        {
                          "success": true,
                          "node": {
                            "type": "feature",
                            "feature": {
                              "type": "api",
                              "api": "NtTerminateProcess"
                            }
                          },
                          "children": [],
                          "locations": [
                            {
                              "type": "absolute",
                              "value": 5368715176
                            }
                          ],
                          "captures": {}
                        },
                        {
                          "success": false,
                          "node": {
                            "type": "feature",
                            "feature": {
                              "type": "api",
                              "api": "ExitProcess"
                            }
                          },
                          "children": [],
                          "locations": [],
                          "captures": {}
                        }
                      ],
                      "locations": [],
                      "captures": {}
                    }
                  ],
                  "locations": [],
                  "captures": {}
                }
              ],
              "locations": [],
              "captures": {}
            }
          ],
          [
            {
              "type": "absolute",
              "value": 5368714096
            },
            {
              "success": true,
              "node": {
                "type": "statement",
                "statement": {
                  "type": "or"
                }
              },
              "children": [
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "api",
                      "api": "System.Diagnostics.Process::Kill"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                },
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "api",
                      "api": "System.Diagnostics.Process::WaitForExit"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                },
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "api",
                      "api": "System.Diagnostics.Process::WaitForExitAsync"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                },
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "api",
                      "api": "System.Environment::Exit"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                },
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "api",
                      "api": "System.Windows.Forms.Application::Exit"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                },
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "api",
                      "api": "exit"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                },
                {
                  "success": false,
                  "node": {
                    "type": "feature",
                    "feature": {
                      "type": "api",
                      "api": "Exit"
                    }
                  },
                  "children": [],
                  "locations": [],
                  "captures": {}
                },
                {
                  "success": true,
                  "node": {
                    "type": "statement",
                    "statement": {
                      "type": "and"
                    }
                  },
                  "children": [
                    {
                      "success": true,
                      "node": {
                        "type": "statement",
                        "statement": {
                          "type": "optional"
                        }
                      },
                      "children": [
                        {
                          "success": false,
                          "node": {
                            "type": "feature",
                            "feature": {
                              "type": "match",
                              "match": "open process"
                            }
                          },
                          "children": [],
                          "locations": [],
                          "captures": {}
                        }
                      ],
                      "locations": [],
                      "captures": {}
                    },
                    {
                      "success": true,
                      "node": {
                        "type": "statement",
                        "statement": {
                          "type": "or"
                        }
                      },
                      "children": [
                        {
                          "success": false,
                          "node": {
                            "type": "feature",
                            "feature": {
                              "type": "api",
                              "api": "TerminateProcess"
                            }
                          },
                          "children": [],
                          "locations": [],
                          "captures": {}
                        },
                        {
                          "success": true,
                          "node": {
                            "type": "feature",
                            "feature": {
                              "type": "api",
                              "api": "NtTerminateProcess"
                            }
                          },
                          "children": [],
                          "locations": [
                            {
                              "type": "absolute",
                              "value": 5368715215
                            }
                          ],
                          "captures": {}
                        },
                        {
                          "success": false,
                          "node": {
                            "type": "feature",
                            "feature": {
                              "type": "api",
                              "api": "ExitProcess"
                            }
                          },
                          "children": [],
                          "locations": [],
                          "captures": {}
                        }
                      ],
                      "locations": [],
                      "captures": {}
                    }
                  ],
                  "locations": [],
                  "captures": {}
                }
              ],
              "locations": [],
              "captures": {}
            }
          ]
        ]
      }
    }
  }
}